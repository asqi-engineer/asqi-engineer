name: "garak"
version: "1.0"
description: "Garak LLM security testing framework container for vulnerability assessment."

input_systems:
  - name: "system_under_test"
    type: "llm_api"
    required: true
    description: "The LLM system being tested"

input_schema:
  - name: "probes"
    type: "list"
    required: false
    description: "List of garak probes to run (e.g., ['ansiescape','ansiescape.AnsiEscaped','ansiescape.AnsiRaw','atkgen','atkgen.Tox','audio','audio.AudioAchillesHeel','av_spam_scanning','av_spam_scanning.EICAR','av_spam_scanning.GTUBE','av_spam_scanning.GTphish','continuation','continuation.ContinueSlursReclaimedSlurs','continuation.ContinueSlursReclaimedSlursFull','dan','dan.Ablation_Dan_11_0','dan.AntiDAN','dan.AutoDAN','dan.AutoDANCached','dan.ChatGPT_Developer_Mode_RANTI','dan.ChatGPT_Developer_Mode_v2','dan.ChatGPT_Image_Markdown','dan.DAN_Jailbreak','dan.DUDE','dan.DanInTheWild','dan.DanInTheWildFull','dan.Dan_10_0','dan.Dan_11_0','dan.Dan_6_0','dan.Dan_6_2','dan.Dan_7_0','dan.Dan_8_0','dan.Dan_9_0','dan.STAN','divergence','divergence.Repeat','divergence.RepeatExtended','donotanswer','donotanswer.DiscriminationExclusionToxicityHatefulOffensive','donotanswer.HumanChatbox','donotanswer.InformationHazard','donotanswer.MaliciousUses','donotanswer.MisinformationHarms','encoding','encoding.InjectAscii85','encoding.InjectBase16','encoding.InjectBase2048','encoding.InjectBase32','encoding.InjectBase64','encoding.InjectBraille','encoding.InjectEcoji','encoding.InjectHex','encoding.InjectMime','encoding.InjectMorse','encoding.InjectNato','encoding.InjectQP','encoding.InjectROT13','encoding.InjectUU','encoding.InjectZalgo','exploitation','exploitation.JinjaTemplatePythonInjection','exploitation.SQLInjectionEcho','exploitation.SQLInjectionSystem','fileformats','fileformats.HF_Files','glitch','glitch.Glitch','glitch.GlitchFull','goodside','goodside.Davidjl','goodside.Tag','goodside.ThreatenJSON','goodside.WhoIsRiley','grandma','grandma.Slurs','grandma.Substances','grandma.Win10','grandma.Win11','latentinjection','latentinjection.LatentInjectionFactSnippetEiffel','latentinjection.LatentInjectionFactSnippetEiffelFull','latentinjection.LatentInjectionFactSnippetLegal','latentinjection.LatentInjectionFactSnippetLegalFull','latentinjection.LatentInjectionReport','latentinjection.LatentInjectionReportFull','latentinjection.LatentInjectionResume','latentinjection.LatentInjectionResumeFull','latentinjection.LatentInjectionTranslationEnFr','latentinjection.LatentInjectionTranslationEnFrFull','latentinjection.LatentInjectionTranslationEnZh','latentinjection.LatentInjectionTranslationEnZhFull','latentinjection.LatentJailbreak','latentinjection.LatentJailbreakFull','latentinjection.LatentWhois','latentinjection.LatentWhoisSnippet','latentinjection.LatentWhoisSnippetFull','leakreplay','leakreplay.GuardianCloze','leakreplay.GuardianClozeFull','leakreplay.GuardianComplete','leakreplay.GuardianCompleteFull','leakreplay.LiteratureCloze','leakreplay.LiteratureClozeFull','leakreplay.LiteratureComplete','leakreplay.LiteratureCompleteFull','leakreplay.NYTCloze','leakreplay.NYTClozeFull','leakreplay.NYTComplete','leakreplay.NYTCompleteFull','leakreplay.PotterCloze','leakreplay.PotterClozeFull','leakreplay.PotterComplete','leakreplay.PotterCompleteFull','lmrc','lmrc.Anthropomorphisation','lmrc.Bullying','lmrc.Deadnaming','lmrc.Profanity','lmrc.QuackMedicine','lmrc.SexualContent','lmrc.Sexualisation','lmrc.SlurUsage','malwaregen','malwaregen.Evasion','malwaregen.Payload','malwaregen.SubFunctions','malwaregen.TopLevel','misleading','misleading.FalseAssertion','packagehallucination','packagehallucination.JavaScript','packagehallucination.PackageHallucinationProbe','packagehallucination.Python','packagehallucination.Ruby','packagehallucination.Rust','phrasing','phrasing.FutureTense','phrasing.FutureTenseFull','phrasing.PastTense','phrasing.PastTenseFull','promptinject','promptinject.HijackHateHumans','promptinject.HijackHateHumansFull','promptinject.HijackKillHumans','promptinject.HijackKillHumansFull','promptinject.HijackLongPrompt','promptinject.HijackLongPromptFull','realtoxicityprompts','realtoxicityprompts.RTPBlank','realtoxicityprompts.RTPFlirtation','realtoxicityprompts.RTPIdentity_Attack','realtoxicityprompts.RTPInsult','realtoxicityprompts.RTPProfanity','realtoxicityprompts.RTPSevere_Toxicity','realtoxicityprompts.RTPSexually_Explicit','realtoxicityprompts.RTPThreat','snowball','snowball.GraphConnectivity','snowball.GraphConnectivityFull','snowball.Primes','snowball.PrimesFull','snowball.Senators','snowball.SenatorsFull','suffix','suffix.BEAST','suffix.GCG','suffix.GCGCached','tap','tap.PAIR','tap.TAP','tap.TAPCached','test','test.Blank','test.Test','topic','topic.WordnetAllowedWords','topic.WordnetBlockedWords','topic.WordnetControversial','visual_jailbreak','visual_jailbreak.FigStep','visual_jailbreak.FigStepFull','xss','xss.ColabAIDataLeakage','xss.MarkdownImageExfil','xss.MdExfil20230929','xss.StringAssemblyDataExfil'])."
  - name: "generations"
    type: "integer"
    required: false
    description: "Number of generations per probe. Defaults to 1."
  - name: "parallel_attempts"
    type: "integer"
    required: false
    description: "How many probe attempts to launch in parallel. Defaults to 8."

output_metrics:
  - name: "success"
    type: "boolean"
    description: "Whether the garak execution completed successfully"
  - name: "score"
    type: "float"
    description: "Overall pass rate (0.0 to 1.0) across all probes and detectors"
  - name: "vulnerabilities_found"
    type: "integer"
    description: "Total number of failed attempts (potential vulnerabilities)"
  - name: "total_attempts"
    type: "integer"
    description: "Total number of probe attempts made"
  - name: "probes_used"
    type: "list"
    description: "List of probes that were executed"
  - name: "generations"
    type: "integer"
    description: "Number of generations per probe that were used"
  - name: "sut_type"
    type: "string"
    description: "Type of system under test"
  - name: "probe_results"
    type: "object"
    description: "Detailed results broken down by probe and detector, including individual scores and attempt counts"
