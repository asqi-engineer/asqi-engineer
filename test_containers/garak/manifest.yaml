name: "garak"
version: "1.0"
description: "Garak LLM security testing framework container for vulnerability assessment."
image_name: "my-registry/garak:latest"

supported_suts:
  - type: "llm_api"
    required_config: ["model"]

input_schema:
  - name: "probes"
    type: "list"
    required: false
    description: "List of garak probes to run (e.g., ['encoding.InjectHex', 'promptinject.Jailbreak', 'dan.Dan_11_0', 'malwaregen.Payload'])."
  - name: "generations"
    type: "integer"
    required: false
    description: "Number of generations per probe. Defaults to 1."
  - name: "config_file"
    type: "string"
    required: false
    description: "Custom garak configuration file content as YAML string."

output_metrics:
  - name: "success"
    type: "boolean"
    description: "Whether the garak execution completed successfully"
  - name: "score"
    type: "float"
    description: "Overall pass rate (0.0 to 1.0) across all probes and detectors"
  - name: "vulnerabilities_found"
    type: "integer"
    description: "Total number of failed attempts (potential vulnerabilities)"
  - name: "total_attempts"
    type: "integer"
    description: "Total number of probe attempts made"
  - name: "probes_used"
    type: "list"
    description: "List of probes that were executed"
  - name: "generations"
    type: "integer"
    description: "Number of generations per probe that were used"
  - name: "sut_type"
    type: "string"
    description: "Type of system under test"
  - name: "probe_results"
    type: "object"
    description: "Detailed results broken down by probe and detector, including individual scores and attempt counts"
