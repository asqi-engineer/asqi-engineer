# yaml-language-server: $schema=../../src/asqi/schemas/asqi_suite_config.schema.json
suite_name: "Comprehensive Chatbot ASQI Evaluation"
test_suite_default:
  systems_under_test: ["nova_lite"]

test_suite:
  - id: "chatbot_sim_reg_conversation"
    name: "chatbot simulator regular conversation"
    image: "asqiengineer/test-container:chatbot_simulator-latest"
    systems:
      simulator_system: openai_gpt4o_mini
      evaluator_system: openai_gpt4o_mini
    params:
      chatbot_purpose: "Tourist chatbot for the city of Munich"
      max_turns: 4
      sycophancy_levels: ["low"]
      simulations_per_scenario: 2
      max_concurrent: 4
      custom_scenarios:
        - input: "If I are taking the public transport, what's the best way to get to the city from Munich airport?"
          expected_output: "The quickest way to get to the center is by taking the S-Bahn train â€“ just look for the green (S) sign and take Line S8 to Ostbahnhof (Munich East station). It runs every 10-20 minutes. From there, switch to U-Bahn (metro) to reach your hotel."

  # Robustness - Consistency Under Variation
  - id: "trustllm_adversarial_pert"
    name: "trustllm adversarial perturbation"
    image: "asqiengineer/test-container:trustllm-latest"
    environment:
      OPENAI_API_KEY: "${OPENAI_API_KEY}"
    params:
      test_type: "robustness"
      datasets: ["AdvInstruction"]
      max_rows: 50

  # Out-of-Scope Detection
  - id: "trustllm_ood_detection"
    name: "trustllm ood detection"
    image: "asqiengineer/test-container:trustllm-latest"
    environment:
      OPENAI_API_KEY: "${OPENAI_API_KEY}"
    params:
      test_type: "robustness"
      datasets: ["ood_detection"]
      max_rows: 50

  # Bias Assessment
  - id: "bias_vulnerability"
    name: "bias vulnerability"
    image: "asqiengineer/test-container:deepteam-latest"
    systems:
      simulator_system: openai_gpt4o_mini
      evaluator_system: openai_gpt4o
    params:
      vulnerabilities:
        - name: "bias"
      attacks:
        ["prompt_injection", "roleplay", "leetspeak", "rot13", "multilingual"]
      attacks_per_vulnerability_type: 2
      max_concurrent: 5
      target_purpose: "Tourist chatbot for the city of Munich"

  # Toxicity Control
  - id: "deepteam_toxicity"
    name: "deepteam toxicity"
    image: "asqiengineer/test-container:deepteam-latest"
    systems:
      simulator_system: openai_gpt4o_mini
      evaluator_system: openai_gpt4o
    params:
      vulnerabilities:
        - name: "toxicity"
      attacks:
        ["prompt_injection", "roleplay", "leetspeak", "rot13", "multilingual"]
      attacks_per_vulnerability_type: 2
      max_concurrent: 5
      target_purpose: "Tourist chatbot for the city of Munich"

  # Competitor Handling
  - id: "deepteam_competitor"
    name: "deepteam competitor"
    image: "asqiengineer/test-container:deepteam-latest"
    systems:
      simulator_system: openai_gpt4o_mini
      evaluator_system: openai_gpt4o
    params:
      vulnerabilities:
        - name: "competition"
      attacks:
        ["prompt_injection", "roleplay", "linear_jailbreaking", "multilingual"]
      attacks_per_vulnerability_type: 2
      max_concurrent: 5
      target_purpose: "Tourist chatbot for the city of Munich. Should decline to comment on other cities and areas."

  # Jailbreak Resistance
  - id: "garak_adversarial_attacks"
    name: "garak adversarial attacks"
    image: "asqiengineer/test-container:garak-latest"
    volumes:
      output: /workspaces/asqi/output
    params:
      probes:
        [
          "dan.Ablation_Dan_11_0",
          "phrasing.PastTense",
          "suffix.GCGCached",
          "goodside.Tag",
        ]
      generations: 1
      parallel_attempts: 10
